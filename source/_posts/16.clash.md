---
title: 一篇有魔力的文章
tags:
  - clash
  - 魔法
categories:
  - 教程
  - 记录
description: 'magic'
date: 2023-04-25 20:08:20
---

magic 碰都不能碰的滑梯

<!-- more -->

# 前言

因为懂得都懂的原因，有一道墙，迫使之前的我只知道百度搜索引擎，但了解到谷歌搜索引擎的好之后，那是真的好。

> 国内建议使用必应搜索引擎，爆杀百度的

我个人使用梯子经历大概是 免费的软件->hxd分享的节点 我第一次用上了clash->找白嫖机场->合租机场->找便宜机场->找白嫖机场->找性价比高的机场（便宜且速度快的新兴小机场）+ 多家不限时机场备用，啊 白嫖多是一件美事，最近找到一篇文章分享了很多可以有免费流量的机场，~~我在想这些白嫖机场合一块，说不定比便宜机场还好用，在试了在试了，这也是写这篇文章的原因~~

> 不过现在用上了好用便宜的付费机场，已经回不去白嫖节点了

# 使用

### 简易版

* ~~**下载 clash**~~

  还在用已经删库的clash for windows和clash for Android？我的建议是速速拥抱新生软件，好用的一，也有Linux的deb安装包

  PC端：[**Clash Verge**](https://github.com/zzzgydi/clash-verge)      **[mihomo-party](https://github.com/mihomo-party-org/mihomo-party)**

  > 教程：[Clash Verge Rev使用指南](https://duangks.com/archives/167/)  

  安卓端：**[ClashMetaForAndroid](https://github.com/MetaCubeX/ClashMetaForAndroid)**
  
  > 教程：  [Clash Meta for Android使用指南](https://duangks.com/archives/169/)
* 机场推荐

  [xfltd](https://xfltd.org/#/register?code=B2lHhzSt)

  [TaiShan](https://www.taishan.pro/#/register?code=Mh5RXLdX)

* 花钱买机场也是个不错的选择，主要是速度会快，体验比较稳定，但是价位有多有少，便宜的几块一个月，中等的一二十一个月，贵的也有100多一个月的

  大多数机场有一个普遍的发展规律，刚起家，人很少—>便宜，带宽负荷暂时较小—>大量推广—>人数变多，负荷增加—>涨价涨价涨价/不涨价但是越来越慢，毕竟人数变多了，典型代表有蜂巢（七元一月涨到现在的二十五元一个月）、一元机场（11一年保持到现在但是人数爆多，tg群已经有7w人了，其实更加恐怖的是我在很多国内应用的软件的评论区多次看到过有人推广，感觉要不太行了）

  大体来说，越贵的越好，但是有些比较虚高，太便宜的机场也不指望多稳定，能用就行，想找性价比的高（价格低，稳定，速度快、不会跑路）的就得多逛逛


### 折腾白嫖版

如果你想白嫖**且愿意折腾**，就用用下面的方法，但是速度应该没多快的

* **生成订阅转换链接**

  这里我们用奶昔订阅转换网址：https://nexconvert.com/

  * 将下面的内容填入`订阅链接`一栏

    ```
    https://sub.pmsub.me/clash.yaml |
    https://sub.sharecentre.online/sub |
    https://git.io/emzclash |
    https://cdn.jsdelivr.net/gh/oslook/clash-freenode@main/clash.yaml |
    https://sub.sharecentre.online/sub |
    https://raw.fastgit.org/freefq/free/master/v2
    ```

    > 此外下面俩个，但总感觉每日更新且地址会变，不太好操作
    >
    > https://freenode.me/f/freenode 每日会更新
    >
    > https://github.com/abshare/abshare.github.io 有每日公益节点 但是几个小时一更新 有点不好嫖
    
  * `远端配置`填

    https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/config/ACL4SSR_Online_Full.ini

  * 点击`生成订阅链接`获得转换后的clash订阅链接

* 按照简易版导入 clash，这时候上个 google、github 应该没什么问题了

### 规则集说明

上面的订阅转换我们填入了一个规则集—https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/config/ACL4SSR_Online_Full.ini

来自一个一直在维护的[项目](https://github.com/ACL4SSR/ACL4SSR/tree/master)，这个规则集能帮助你判断哪些网站需要走代理，哪些不需要代理，这也就是我们说的**规则代理**，在clash中的connections中可以查看

常用匹配规则有 `DOMAIN-SUFFIX`（域名后缀匹配）、`DOMAIN`（域名匹配）、`DOMAIN-KEYWORD`（域名关键字匹配），比如你登录谷歌然后点 `Connections` 然后搜索 google

![1.png](https://s2.loli.net/2023/04/29/YDFjBILlOEz6qfh.png)

可以看到他的 Rule 是 DomainKeyword (google) 然后先进入了` 🚀 节点选择`的规则组，我在 `🚀 节点选择`规则组中选择了 `♻️ 自动选择`规则组，`♻️ 自动选择`规则组是使用了 `url-test` 也就是测速然后选择一个延迟最快的，然后选到了一个节点

![2.png](https://s2.loli.net/2023/04/29/BwyZY4NOmzLHnlb.png)

  ![3.png](https://s2.loli.net/2023/04/29/sFGyqNA7Bj1x5gT.png)

为了让规则说明更加的清楚，下面用一份示例说明一下

```
port: 7890
socks-port: 7891
allow-lan: true
mode: Rule
log-level: info
external-controller: :9090
proxies: 
  - { name: 节点一, xxxxxx }
  - { name: 节点二, xxxxxx }
proxy-groups:
  - name: 🚀 节点选择
    type: select
    proxies:
      - ♻️ 自动选择
      - 🚀 手动切换
      - DIRECT
  - name: 🚀 手动切换
    type: select
    proxies:
      - 节点一
      - 节点二
  - name: ♻️ 自动选择
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    proxies:
      - 节点一
      - 节点二
  - name: 🐟 漏网之鱼
    type: select
    proxies:
      - 🚀 节点选择
      - 🚀 手动切换
      - ♻️ 自动选择
      - DIRECT
      - 节点一
      - 节点二
rules:
 - DOMAIN-KEYWORD,google,🚀 节点选择
 - MATCH,🐟 漏网之鱼
```

* `allow-lan`：是否允许局域网共享，true 可以让局域网其他设备使用`ip:端口`使用你的代理，使用clash软件可以在首页设置

* `proxies`：代理链接，买机场的代理买的就是这个字段，通过 http、socks5、ss、ssr、vmess、trojan等协议传输数据
* `proxy-groups`：规则组设置，这里我们设置了四个规则组做示例：🚀 节点选择、🚀 手动切换、♻️ 自动选择、🐟 漏网之鱼
* `rules`：规则设置，这里我们仅用两个规则做演示

在clash界面他看起来是这样的

![4.png](https://s2.loli.net/2023/04/29/Gv4fHkxNZ3RbgYI.png)

**流程演示1：**

* 假如我们访问 www.google.com 先从rules 中从上往下依次匹配规则，根据域名关键字（DOMAIN-KEYWORD）匹配到了google，所以该网站流量进入`🚀 节点选择`规则组，`🚀 节点选择`是 select 模式，即需要用户自行选择一个节点/规则组

* 在`🚀 节点选择`规则组中我们选择了`♻️ 自动选择`规则组，而`♻️ 自动选择`规则组是 url-test 模式，该规则组会依据延迟选择延迟最低的一个节点（不过有说法是延迟低的带宽小，未验证，不知道）

* 再按之前的方法在 connections 中验证一下

  ![image-20230429151009315.png](https://s2.loli.net/2023/05/01/M1iCsjo9yPaxcL6.png)

**流程演示2：**

* 假如我们访问的是其他网站，比如 www.baidu.com 因为在规则中没有匹配，于是最终匹配到了`MATCH,🐟 漏网之鱼`，MATCH 是全匹配，意思没有写在规则的网站都会进入这里，一般默认选择节点选择，但是也可以指定到 DIRECT（直连，即不走代理）

**总结：**

所以，用大佬的规则就完了（

这里有个好东西，把这几个勾上有时候能解决几个问题，就是在切换节点/代理文件/模式时会切断所有的connection

![image.png](https://s2.loli.net/2023/06/02/H5fzCS2JbM7eEWK.png)

# docker版clash

当前路径下放置`config.yaml`

前几行参考示例：

```
mixed-port: 7890
allow-lan: true
bind-address: '*'
mode: rule
log-level: info
external-controller: '0.0.0.0:9090'
proxies:
```

**一定要设置allow-lan: true 允许局域网，否则是无法使用的**

运行docker

```
docker run -d --name clash-client --restart always -p 7890:7890 -p 7891:7891 -p 9090:9090 -v ./config.yaml:/root/.config/clash/config.yaml  dreamacro/clash
```

运行yacd面板

```
docker run -p 1234:80 -d --rm --name yacd haishanh/yacd
```

访问`IP:1234`，填写`http://IP:9090`即可

使用`proxychains4`时填写`http 127.0.0.1 7890`

或者直接执行`export http_proxy=http://127.0.0.1:7890`
